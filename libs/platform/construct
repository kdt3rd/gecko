
local xlib = subdir "xlib";
local wayland = subdir "wayland";
local cocoa = subdir "cocoa";
local mswin = subdir "mswin";

function combine(a, b)
	local r = a;
	for i, v in ipairs(b) do
		table.insert(r, v);
	end
	return r
end

lib = library "platform"
  source{
		"platform.cpp";
		"system.cpp";
		"screen.cpp";
		"window.cpp";
		"timer.cpp";
		"keyboard.cpp";
		"mouse.cpp";
		"dispatcher.cpp";
		"waitable.cpp";
		cocoa.extra_source;
		mswin.extra_source;
  }
  optional_source{
	  {
		  system="Linux";
		  source={
			  "linux.cpp";
			  xlib.extra_source;
			  wayland.extra_source;
		  };
	  },
	  {
		  system="Darwin";
		  source={ "darwin.cpp" };
		  libs=cocoa.extra_libs;
	  },
	  {
		  system="Windows";
		  source={ "mswin.cpp" };
		  libs=mswin.extra_libs;
	  },
  }
  libs{ "utf", "base" }
