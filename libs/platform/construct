
local xlib = subdir "xlib";
local wayland = subdir "wayland";
local cocoa = subdir "cocoa";
local mswin = subdir "mswin";

function combine(a, b)
	local r = a;
	for i, v in ipairs(b) do
		table.insert(r, v);
	end
	return r
end

lib = library "platform"
  source{
		"platform.cpp";
		"system.cpp";
		"screen.cpp";
		"window.cpp";
		"timer.cpp";
		"keyboard.cpp";
		"mouse.cpp";
		"dispatcher.cpp";
		"waitable.cpp";
		xlib.extra_source;
		wayland.extra_source;
		cocoa.extra_source;
		mswin.extra_source;
  }
  optional_source{
	  {
		  system="Linux";
		  source={ "linux.cpp" };
	  },
	  {
		  system="Darwin";
		  source={ "darwin.cpp" };
	  },
	  {
		  system="Windows";
		  source={ "mswin.cpp" };
	  },
  }
  libs{ "utf", "base" }
  system_libs{
	  system="Linux";
	  libs=combine(xlib.extra_libs, wayland.extra_libs);
  }
  system_libs{
	  system="Darwin";
	  libs=cocoa.extra_libs;
  }
  system_libs{
	  system="Windows";
	  libs=mswin.extra_libs;
  }
